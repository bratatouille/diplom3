{% extends 'base.html' %}
{% load static %}

{% block content %}

<div class="min-h-screen  text-gray-900 dark:text-white">
    <div class="max-w-5xl mx-auto py-10">
        <h1 class="text-3xl font-bold mb-6">Поддержка</h1>
        <div class="bg-gray-100 dark:bg-gray-800 rounded-xl p-6 mb-6 flex flex-col gap-6">
            {% if messages %}
                {% for message in messages %}
                    <div class="{% if message.tags == 'success' %}bg-green-700{% else %}bg-red-700{% endif %} text-white rounded p-4 mb-4">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-gray-200 dark:bg-gray-700 rounded-lg p-6 flex flex-col items-center">
                    <svg class="w-8 h-8 mb-2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z" stroke-width="2"/></svg>
                    <div class="font-semibold text-gray-900 dark:text-white">Адрес</div>
                    <div class="text-gray-500 dark:text-gray-400 text-sm">г. Таганрог, ул. Дачная, д.119</div>
                </div>
                <div class="bg-gray-200 dark:bg-gray-700 rounded-lg p-6 flex flex-col items-center">
                    <svg class="w-8 h-8 mb-2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 8v4l3 3" stroke-width="2"/><circle cx="12" cy="12" r="10" stroke-width="2"/></svg>
                    <div class="font-semibold text-gray-900 dark:text-white">Режим работы</div>
                    <div class="text-gray-500 dark:text-gray-400 text-sm">Пн-Вс: 10:00 - 22:00</div>
                </div>
                <div class="bg-gray-200 dark:bg-gray-700 rounded-lg p-6 flex flex-col items-center">
                    <svg class="w-8 h-8 mb-2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M22 16.92V19a2 2 0 0 1-2.18 2A19.72 19.72 0 0 1 3 5.18 2 2 0 0 1 5 3h2.09a2 2 0 0 1 2 1.72c.13 1.13.37 2.24.72 3.32a2 2 0 0 1-.45 2.11l-1.27 1.27a16 16 0 0 0 6.29 6.29l1.27-1.27a2 2 0 0 1 2.11-.45c1.08.35 2.19.59 3.32.72A2 2 0 0 1 22 16.92z" stroke-width="2"/></svg>
                    <div class="font-semibold text-gray-900 dark:text-white">Телефон</div>
                    <div class="text-gray-500 dark:text-gray-400 text-sm">+7 (999) 999-99-99</div>
                </div>
            </div>
            <div class="flex gap-4 mt-4">
                <button id="faqTab" class="flex-1 py-2 rounded font-semibold transition-colors bg-violet-700 text-white" onclick="showTab('faq')">Частые вопросы</button>
                <button id="supportTab" class="flex-1 py-2 rounded font-semibold transition-colors bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-white" onclick="showTab('support')">Написать в поддержку</button>
            </div>
            <!-- FAQ -->
            <div id="faqContent" class="mt-4">
                <div class="bg-gray-200 dark:bg-gray-700 rounded-lg p-4 mb-2">
                    <button class="w-full text-left font-semibold flex justify-between items-center text-gray-900 dark:text-white" onclick="toggleFaq(0)">
                        Как оформить заказ?
                        <span id="faqArrow0" class="transition-transform">&#9660;</span>
                    </button>
                    <div id="faqAnswer0" class="text-gray-500 dark:text-gray-400 text-sm mt-2 hidden">
                        Выберите товары в каталоге, добавьте их в корзину и следуйте инструкциям по оформлению заказа. Оплатить можно картой или при получении.
                    </div>
                </div>
                <div class="bg-gray-200 dark:bg-gray-700 rounded-lg p-4 mb-2">
                    <button class="w-full text-left font-semibold flex justify-between items-center text-gray-900 dark:text-white" onclick="toggleFaq(1)">
                        Какие условия доставки?
                        <span id="faqArrow1" class="transition-transform">&#9660;</span>
                    </button>
                    <div id="faqAnswer1" class="text-gray-500 dark:text-gray-400 text-sm mt-2 hidden">
                        Доставка осуществляется по всей России. Стоимость и сроки зависят от региона.
                    </div>
                </div>
                <div class="bg-gray-200 dark:bg-gray-700 rounded-lg p-4 mb-2">
                    <button class="w-full text-left font-semibold flex justify-between items-center text-gray-900 dark:text-white" onclick="toggleFaq(2)">
                        Как оформить возврат?
                        <span id="faqArrow2" class="transition-transform">&#9660;</span>
                    </button>
                    <div id="faqAnswer2" class="text-gray-500 dark:text-gray-400 text-sm mt-2 hidden">
                        Для возврата товара свяжитесь с нашей поддержкой и следуйте инструкциям.
                    </div>
                </div>
                <div class="bg-gray-200 dark:bg-gray-700 rounded-lg p-4 mb-2">
                    <button class="w-full text-left font-semibold flex justify-between items-center text-gray-900 dark:text-white" onclick="toggleFaq(3)">
                        Какая гарантия на товары?
                        <span id="faqArrow3" class="transition-transform">&#9660;</span>
                    </button>
                    <div id="faqAnswer3" class="text-gray-500 dark:text-gray-400 text-sm mt-2 hidden">
                        На все товары предоставляется официальная гарантия от производителя.
                    </div>
                </div>
                <div class="bg-gray-200 dark:bg-gray-700 rounded-lg p-4">
                    <button class="w-full text-left font-semibold flex justify-between items-center text-gray-900 dark:text-white" onclick="toggleFaq(4)">
                        Есть ли самовывоз?
                        <span id="faqArrow4" class="transition-transform">&#9660;</span>
                    </button>
                    <div id="faqAnswer4" class="text-gray-500 dark:text-gray-400 text-sm mt-2 hidden">
                        Да, вы можете забрать заказ самостоятельно по адресу магазина.
                    </div>
                </div>
            </div>
            <!-- Support Form -->
            <div id="supportContent" class="mt-4 hidden">
                <form class="space-y-4" method="post" action="{% url 'core:support' %}">
                    {% csrf_token %}
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {% if user.is_authenticated %}
                        <input type="text" name="name" placeholder="{{ user.first_name }} {{ user.last_name }}" value="{{ user.first_name }} {{ user.last_name }}" required class="bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded px-4 py-2 w-full focus:outline-none focus:border-violet-700">
                        <input type="email" name="email" placeholder="{{ user.email }}" value="{{ user.email }}" required class="bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded px-4 py-2 w-full focus:outline-none focus:border-violet-700">
                    {% else %}
                        <input type="text" name="name" placeholder="Ваше имя" required class="bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded px-4 py-2 w-full focus:outline-none focus:border-violet-700">
                        <input type="email" name="email" placeholder="Email" required class="bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded px-4 py-2 w-full focus:outline-none focus:border-violet-700">
                    {% endif %}
                    </div>
                    <select name="topic" class="bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded px-4 py-2 w-full focus:outline-none focus:border-violet-700">
                        <option value="general">Общий вопрос</option>
                        <option value="order">Вопрос по заказу</option>
                        <option value="delivery">Вопрос по доставке</option>
                        <option value="return">Вопрос по возврату</option>
                    </select>
                    <textarea name="message" rows="4" placeholder="Сообщение" required class="bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded px-4 py-2 w-full focus:outline-none focus:border-violet-700"></textarea>
                    <button type="submit" class="w-full py-2 rounded bg-violet-700 font-semibold hover:bg-violet-800 transition-colors">Отправить</button>
                </form>
            </div>
        </div>
    </div>
</div>
<script>
    function showTab(tab) {
        const tabs = [
            {id: 'faqTab', content: 'faqContent', active: tab === 'faq'},
            {id: 'supportTab', content: 'supportContent', active: tab === 'support'}
        ];
        tabs.forEach(t => {
            const btn = document.getElementById(t.id);
            if (t.active) {
                btn.classList.add('bg-violet-700', 'text-white');
                btn.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-900', 'dark:text-white');
            } else {
                btn.classList.remove('bg-violet-700', 'text-white');
                btn.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-900', 'dark:text-white');
            }
            document.getElementById(t.content).classList.toggle('hidden', !t.active);
        });
    }
    function toggleFaq(idx) {
        const answer = document.getElementById('faqAnswer' + idx);
        const arrow = document.getElementById('faqArrow' + idx);
        answer.classList.toggle('hidden');
        arrow.style.transform = answer.classList.contains('hidden') ? 'rotate(0deg)' : 'rotate(180deg)';
    }
    // По умолчанию показываем FAQ
    showTab('faq');
</script>
{% endblock %}